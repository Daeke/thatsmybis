function addItemAutocompleteHandler(){$(".js-item-autocomplete").each(function(){var t=this;$(this).autocomplete({source:function source(e,n){$.ajax({method:"get",dataType:"json",url:"/api/items/query/"+e.term,success:function success(i){n(i),i.length<=0&&($(t).nextAll(".js-status-indicator").show(),$(t).nextAll(".js-status-indicator").html('<span class="bg-danger">&nbsp;'+e.term+" not found&nbsp;</span>"))},error:function error(){}})},search:function search(){$(this).nextAll(".js-status-indicator").hide(),$(this).nextAll(".js-status-indicator").empty(),$(this).nextAll(".js-loading-indicator").show()},response:function response(){$(this).nextAll(".js-loading-indicator").hide()},select:function select(t,e){if(e.item.value)return value=e.item.value,label=e.item.label,Number.isInteger(value)&&addTag(this,value,label),!1},minLength:1,delay:400})})}function addItemListSelectHandler(){$(".js-input-item").change(function(){$(this).find(":selected").val(),$(this).find(":selected").html().trim(),value=$(this).find(":selected").val(),label=$(this).find(":selected").html().trim(),$nextInput=$(this).next("ul").children("li").children("input[value='']").first(),""==$nextInput.val()?($nextInput.parent("li").show(),$nextInput.val(value),$nextInput.siblings("input[value='']").first().val(label),$nextInput.siblings(".js-input-label").html(" "+label),$(this).val(""),$(this).find("option:first").text("—")):($(this).val(""),$(this).find("option:first").text("maximum added"))})}function addTagInputHandlers(){$(".js-item-autocomplete").keyup(function(t){keys=[13],$.inArray(t.keyCode,keys)>=0&&(t.preventDefault(),value=this.value,label=value,Number.isInteger(value)&&addTag(this,value,label))}),$(".js-item-autocomplete").focusout(function(){$(this).val()&&(value=this.value,label=value,Number.isInteger(value)&&addTag(this,value,label))})}function addItemRemoveHandler(){$(".js-input-button").click(function(){$(this).prev("input").val(""),$(this).prev("input").prev("input").val(""),$(this).parent("li").hide(),$(this).parent("li").parent("ul").siblings(".js-input-select").find("option:first").text("—"),textInput=$(this).parent("li").parent("ul").siblings(".js-input-text"),textInput.val()&&textInput.val().match("^maximum")&&textInput.val().match("added$")&&textInput.val("")})}function addTag(t,e,n){if(t&&e&&n)return $nextInput=$(t).next().next("ul").children("li").children("input[value='']").first(),""==$nextInput.val()?($nextInput.parent("li").show(),$nextInput.val(e),$nextInput.siblings("input[value='']").first().val(n),$nextInput.siblings(".js-input-label").html(" "+n),$(t).val(""),!0):($(t).val("maximum items added"),!1)}$(document).ready(function(){addItemAutocompleteHandler(),addItemListSelectHandler(),addItemRemoveHandler(),addTagInputHandlers(),$(".js-sortable").sortable({handle:".js-sort-handle"})});
