var timestampUpdateInterval=null;function addInputAntiSubmitHandler(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":text";$(t).on("keypress keyup",function(t){if(13==t.which)return!1})}function addNoteHandlers(){$(".js-show-note-edit").click(function(){$(".js-note-input").toggle()})}function decToHex(t){return parseInt(t).toString(16)}function getColorFromDec(t){if(t=parseInt(t))for(t=decToHex(t);t.length<6;)t="0"+t;else t="FFF";return"#"+t}function slug(t){var e="-",a="àáäâãåăæçèéëêǵḧìíïîḿńǹñòóöôœṕŕßśșțùúüûǘẃẍÿź·/_,:;",n="aaaaaaaaceeeeghiiiimnnnoooooprssstuuuuuwxyz------",r=new RegExp(a.split("").join("|"),"g"),s=t.toString().toLowerCase().replace(/\s+/g,"-").replace(r,function(t){return n.charAt(a.indexOf(t))}).replace(/&/g,"").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/-+/g,"-").substr(0,50);return s||"-"}function trackTimestamps(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;$(".js-watchable-timestamp").each(function(){var t;$(this).data("isShort")&&moment.locale("en",{relativeTime:{past:"%s ago",s:"seconds",ss:"%ss",m:"~1m",mm:"%dm",h:"~1h",hh:"%dh",d:"~1d",dd:"%dd",M:"~1mo",MM:"%dM",y:"~1y",yy:"%dY"}});var e=$(this).data("timestamp");e<1e12&&(e*=1e3);var a=!1;e>Date.now()&&(a=!0);var n=null,r=$(this).data("maxDays");r&&e<moment().valueOf()-864e5*r?n="over 2 weeks":(n=moment.utc(e).fromNow(!0),console.log(n)),$(this).is("abbr")?$(this).prop("title",(a?"in ":"")+n+(a?"":" ago")):$(this).html(n)}),$(".js-timestamp").each(function(){var t=$(this).data("timestamp");t<1e12&&(t*=1e3);var e=$(this).data("format")?$(this).data("format"):"dddd, MMMM Do YYYY, h:mm a",a=moment.utc(t).format(e);$(this).is("abbr")?$(this).prop("title",a):$(this).html(a)}),$(".js-timestamp-title").each(function(){var t=$(this).data("title"),e=$(this).data("timestamp");e<1e12&&(e*=1e3);var a=moment.utc(e).local().format("dddd, MMMM Do YYYY, h:mm a");t?$(this).prop("title",t+" "+a):$(this).prop("title",a)}),timestampUpdateInterval&&clearInterval(timestampUpdateInterval),timestampUpdateInterval=setInterval(function(){$(".js-watchable-timestamp").each(function(){var t=$(this).data("timestamp");t<1e12&&(t*=1e3);var e=!1;t>Date.now()&&(e=!0);var a=null,n=$(this).data("maxDays");a=n&&t<moment().valueOf()-864e5*n?"over 2 weeks":moment.utc(t).fromNow(!0),$(this).is("abbr")?$(this).prop("title",(e?"in ":"")+a+(e?"":" ago")):$(this).html(a)})},t)}function nl2br(t){return t?t.replace(/\n/g,"<br>"):""}function cleanUrl(t,e,a){if(t){try{var n=decodeURIComponent(unescape(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}e&&!originIndependentUrl.test(a)&&(a=resolveUrl(e,a));try{a=encodeURI(a).replace(/%25/g,"%")}catch(t){return null}return a}function parseMarkdown(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=new marked.Renderer;e.link=function(t,e,a){var n="";return null===(t=cleanUrl(this.options.sanitize,this.options.baseUrl,t))?a:(n+='<a target="_blank" href="'+t+'"',e&&(n+=' title="'+e+'"'),n+=">"+a+"</a>")},t&&!t.hasClass("js-markdown-parsed")?(t.html(marked(t.html(),{renderer:e})),t.addClass("js-markdown-parsed")):($(".js-markdown").each(function(){$(this).hasClass("js-markdown-parsed")||($(this).html(marked($.trim($(this).text()),{renderer:e})),$(this).addClass("js-markdown-parsed"))}),$(".js-markdown-inline").each(function(){$(this).hasClass("js-markdown-parsed")||($(this).html(marked.inlineLexer($.trim($(this).text()),{renderer:e})),$(this).addClass("js-markdown-parsed"))}))}function rgbToHex(t){for(var e=Number(t).toString(16);e.length<6;)e="0"+e;return e}function makeWowheadLinks(){try{$WowheadPower.refreshLinks()}catch(t){console.log("Failed to refresh wowhead links.")}}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),marked.setOptions({gfm:!0,breaks:!0}),$(document).ready(function(){parseMarkdown(),makeWowheadLinks(),trackTimestamps(),addInputAntiSubmitHandler(),addNoteHandlers(),$(".js-edit-content").click(function(t){t.preventDefault();var e=$(this).data("id");$(".js-content[data-id="+e+"]").toggle()})});
